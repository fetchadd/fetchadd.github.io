<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title></title>
    <link rel="shortcut icon" type="image/x-icon" href="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;image&#x2F;favicon.ico">
    <script type="text/javascript" src="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;js&#x2F;jquery-3.4.1.js"></script>

    

    <link rel="stylesheet" href="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;site.css">
    
</head>

<body>
<div id="container">
    <div id="header">
        <div id="header-content">
            
            <ul id="main-menu">
                
                    
                        
    
        <li class="main-menu-item">
            
                
            

            

            <a href=https:&#x2F;&#x2F;fetchadd.github.io&#x2F;blogs&#x2F;
                       
                           class="current"
                        >

                Blogs
            </a>
        </li>
    

                    
                        
    
        <li class="main-menu-item">
            
                
            

            

            <a href=&#x2F;categories
                        >

                Categories
            </a>
        </li>
    

                    
                        
    
        <li class="main-menu-item">
            
                
            

            

            <a href=https:&#x2F;&#x2F;fetchadd.github.io&#x2F;archives&#x2F;
                        >

                Archives
            </a>
        </li>
    

                    
                        
    
        <li class="main-menu-item">
            
                
            

            

            <a href=https:&#x2F;&#x2F;fetchadd.github.io&#x2F;about&#x2F;
                        >

                About
            </a>
        </li>
    

                    
                
            </ul>

            <div id="menu-padding"></div>

            <div class="search-container">
                <input id="search" type="search" placeholder="Search">

                <div class="search-result">
                    <div class="search-result-items"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="content-container">
            <div id="content">
            
<div id="blog-content">
    
    <header class="blog-header">
        <h1 class="blog-title">
            <a href="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;blogs&#x2F;code-property-graph-diao-yan&#x2F;">cpg analysis</a>
        </h1>
        <div class="blog-meta">
            
                <span class="blog-time">2019-07-26</span>
            

            
        </div>
    </header>

    <h3 id="code-property-graph-diao-yan">code property graph 调研</h3>
<h4 id="1-zi-liao">1. 资料</h4>
<p>https://joern.io/docs/essentials/installing/</p>
<p>https://docs.shiftleft.io/shiftleft/using-shiftleft-ocular/getting-started </p>
<p>ocular是shiftleft的java2cpg产品，比开源的joern稍微好用点，功能更齐全，有14天的试用期，只能做一些基本的分析（无规则），正式版有。</p>
<p>实际项目中(fastjson) callgraph无法使用，所以使用ocular，但好像也有点问题</p>
<p>https://research.cs.wisc.edu/wpis/papers/popl95.pdf</p>
<h4 id="2-jie-gou">2. 结构</h4>
<h5 id="2-1-ast">2.1 AST</h5>
<p>应该是由antr4生成的ast</p>
<p>AST2CPG:</p>
<table><thead><tr><th align="left">AST</th><th align="left">CPG</th><th>AST visit</th></tr></thead><tbody>
<tr><td align="left">Paramter</td><td align="left">METHOD_PARAMETER_IN</td><td></td></tr>
<tr><td align="left">Argument</td><td align="left"></td><td>Expression</td></tr>
<tr><td align="left">ArgumentList</td><td align="left"></td><td>Argument</td></tr>
<tr><td align="left">AssignmentExpression</td><td align="left"></td><td>BinaryExpr</td></tr>
<tr><td align="left">BinaryExpr</td><td align="left">CALL&amp;METHOD_INST</td><td></td></tr>
<tr><td align="left">ClassDefStatement</td><td align="left">TYPE_DECL</td><td>content</td></tr>
<tr><td align="left">Statement</td><td align="left">not imp</td><td></td></tr>
<tr><td align="left">CastTarget</td><td align="left">UNKNOW</td><td></td></tr>
<tr><td align="left">InitializeList</td><td align="left">not imp</td><td></td></tr>
<tr><td align="left">PtrMemberAccess</td><td align="left">CALL(indirectMemberAccess)&amp;METHOD_INST</td><td>child</td></tr>
<tr><td align="left">MemberAccess</td><td align="left">CALL(memberAccess)&amp;METHOD_INST</td><td>child</td></tr>
<tr><td align="left">CastExpression</td><td align="left">CALL(case)&amp;METHOD_INST</td><td>CastTarget&amp;Expression</td></tr>
<tr><td align="left">ArrayIndexin</td><td align="left">CALL(computedMemberAccess)&amp;METHOD_INST</td><td>ArrayExp;IndexExp</td></tr>
<tr><td align="left">Label</td><td align="left">UNKNOW</td><td></td></tr>
<tr><td align="left">SizeofOperand</td><td align="left">UNKNOW/Other</td><td>Expression</td></tr>
<tr><td align="left">SizeofExpression</td><td align="left">CALL(sizeOf)&amp;METHOD_INST</td><td>child[1]</td></tr>
<tr><td align="left">IdentifierDecl(*)</td><td align="left">TYPE_DECL; MEMBER;LOCAL</td><td>;;Expression</td></tr>
<tr><td align="left">IdentifierDeclStatement</td><td align="left"></td><td>IdentifierDecl</td></tr>
<tr><td align="left">ReturnStatement</td><td align="left">RETURN</td><td>Expression(opt.)</td></tr>
<tr><td align="left">CompoundStatement</td><td align="left">BLOCK</td><td>Statement</td></tr>
<tr><td align="left">ExpressionStatement</td><td align="left"></td><td>Expression</td></tr>
<tr><td align="left">IfStatement</td><td align="left">UNKNOW</td><td>Condition&amp;Statment&amp;ElseStmt</td></tr>
<tr><td align="left">ThrowStatement</td><td align="left">UNKNOW</td><td>Expression</td></tr>
<tr><td align="left">CatchList</td><td align="left">UNKNOW</td><td>CatchElement</td></tr>
<tr><td align="left">BlockStarter</td><td align="left">UNKNOW</td><td>child</td></tr>
<tr><td align="left">ForInit</td><td align="left"></td><td>child</td></tr>
<tr><td align="left">Expression</td><td align="left">BLOCK</td><td>child</td></tr>
<tr><td align="left">ConditionExpression</td><td align="left">Call(<operator>.conditionalExpression)&amp;METHOD_INST</td><td>child</td></tr>
<tr><td align="left">Condition</td><td align="left"></td><td>Expression</td></tr>
<tr><td align="left">Identifier</td><td align="left">IDENTIFIER</td><td></td></tr>
<tr><td align="left">GotoStatement</td><td align="left">UNKNOW</td><td></td></tr>
<tr><td align="left">ContinueStatement</td><td align="left">UNKNOW</td><td></td></tr>
<tr><td align="left">BreakStatement</td><td align="left">UNKNOW</td><td></td></tr>
<tr><td align="left">Constant</td><td align="left">LITERAL</td><td></td></tr>
<tr><td align="left">CallExpression</td><td align="left">CALL&amp;METHOD_INST</td><td>ArgumentList</td></tr>
<tr><td align="left">PostIncDecOperationExpression</td><td align="left">CALL&amp;METHOD_INST</td><td>child</td></tr>
<tr><td align="left">UnaryExpression</td><td align="left">CALL&amp;METHOD_INST;UNKNOW(no child)</td><td></td></tr>
<tr><td align="left">And/xxx/xx/xxExpression</td><td align="left"></td><td>BinaryExpr</td></tr>
<tr><td align="left">FunctionDefBase</td><td align="left">METHOD&amp;METHOD_RETURN</td><td>ParameterList</td></tr>
<tr><td align="left"></td><td align="left"></td><td></td></tr>
</tbody></table>
<h5 id="2-2-cfg">2.2 CFG</h5>
<p>CFG就很简单，添加CFG边就完事了。主要4 种类型的边：</p>
<p>True， False， Always,  Case</p>
<p>实现一个是layer，这个主要是标志作用域，比如for，while这种类型的statement会push一个layer</p>
<p>还有就是fringe结构，在每遍历一个CFG节点时，都会把fringe里的边添加到该节点上，比如fringe里是</p>
<p>[{BreakStatementNode: Always}]，那么在遍历下个节点时就会给该节点和BreakStatementNode添加一条Always边，所以fringe的作用就是存储下一个遍历节点的前驱。这里看一个for statement的实现：</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">override def </span><span style="color:#4271ae;">visit</span><span style="color:#111111;">(</span><span style="color:#f07219;">forStatement</span><span style="color:#111111;">: </span><span style="color:#c99e00;">ForStatement</span><span style="color:#111111;">): </span><span style="color:#8959a8;">Unit </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    breakStack.pushLayer() </span><span style="color:#8e908c;">// for 可能嵌套</span><span style="color:#111111;">
    continueStack.pushLayer() </span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#f07219;">Option</span><span style="color:#111111;">(forStatement.getForInitExpression).foreach(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.accept(</span><span style="color:#c82728;">this</span><span style="color:#111111;">)) </span><span style="color:#8e908c;">//先解析init，可能会有</span><span style="color:#111111;">
</span><span style="color:#111111;">
    markerStack </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">None</span><span style="color:#111111;"> :: markerStack</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">conditionOption </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Option</span><span style="color:#111111;">(forStatement.getCondition) </span><span style="color:#8e908c;">//解析condition</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">conditionFringe </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
    conditionOption </span><span style="color:#8959a8;">match </span><span style="color:#111111;">{</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">case </span><span style="color:#f07219;">Some</span><span style="color:#111111;">(</span><span style="color:#f07219;">condition</span><span style="color:#111111;">) </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        condition.accept(</span><span style="color:#c82728;">this</span><span style="color:#111111;">) </span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">storedFringe </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> fringe</span><span style="color:#111111;">
        fringe </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> fringe.setCfgEdgeType(</span><span style="color:#f07219;">TrueEdge</span><span style="color:#111111;">) </span><span style="color:#8e908c;">// condition的true是body</span><span style="color:#111111;">
        storedFringe</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">case </span><span style="color:#f07219;">None </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        fringe.empty()</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
</span><span style="color:#111111;">
    forStatement.getStatement.accept(</span><span style="color:#c82728;">this</span><span style="color:#111111;">) </span><span style="color:#8e908c;">// 解析body，以便取出continue和break，body的后继是loop</span><span style="color:#111111;">
</span><span style="color:#111111;">
    fringe </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> fringe.add(continueStack.getTopElements, </span><span style="color:#f07219;">AlwaysEdge</span><span style="color:#111111;">) </span><span style="color:#8e908c;">//continue的always是loop</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#f07219;">Option</span><span style="color:#111111;">(forStatement.getForLoopExpression).foreach(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.accept(</span><span style="color:#c82728;">this</span><span style="color:#111111;">)) </span><span style="color:#8e908c;">// 解析loop</span><span style="color:#111111;">
</span><span style="color:#111111;">
    markerStack.head.foreach(extendCfg) </span><span style="color:#8e908c;">//不懂，没被赋值，应该是做一些特殊节点的处理</span><span style="color:#111111;">
</span><span style="color:#111111;">
    fringe </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> conditionFringe</span><span style="color:#111111;">
    .setCfgEdgeType(</span><span style="color:#f07219;">FalseEdge</span><span style="color:#111111;">) </span><span style="color:#8e908c;">//condition的false是exit</span><span style="color:#111111;">
    .add(breakStack.getTopElements, </span><span style="color:#f07219;">AlwaysEdge</span><span style="color:#111111;">) </span><span style="color:#8e908c;">// break的always是exit</span><span style="color:#111111;">
</span><span style="color:#111111;">
    markerStack </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> markerStack.tail</span><span style="color:#111111;">
    breakStack.popLayer() </span><span style="color:#8e908c;">//for结束</span><span style="color:#111111;">
    continueStack.popLayer()</span><span style="color:#111111;">
}</span><span style="color:#111111;">
</span></pre><h5 id="2-3-cpg">2.3 CPG</h5>
<p>开源版见图，这里列出的是所有边和节点，需要注意的是并不是所有边和节点都会用到</p>
<h6 id="2-3-1-edge">2.3.1 Edge</h6>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ALIAS_OF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ALIAS_OF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String AST </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;AST&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ATTACHED_DATA </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ATTACHED_DATA&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String BINDS_TO </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;BINDS_TO&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL_ARG </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL_ARG&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL_ARG_OUT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL_ARG_OUT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL_RET </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL_RET&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CAPTURE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CAPTURE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CAPTURED_BY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CAPTURED_BY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CDG </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CDG&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CFG </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CFG&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CONTAINS </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CONTAINS&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CONTAINS_NODE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CONTAINS_NODE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DOMINATE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DOMINATE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String EVAL_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;EVAL_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String INHERITS_FROM </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;INHERITS_FROM&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IS_SENSITIVE_DATA_DESCR_OF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IS_SENSITIVE_DATA_DESCR_OF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IS_SENSITIVE_DATA_DESCR_OF_REF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IS_SENSITIVE_DATA_DESCR_OF_REF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IS_SENSITIVE_DATA_OF_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IS_SENSITIVE_DATA_OF_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PARAMETER_LINK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PARAMETER_LINK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String POST_DOMINATE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;POST_DOMINATE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PROPAGATE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PROPAGATE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String REACHING_DEF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;REACHING_DEF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String RECEIVER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;RECEIVER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String REF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;REF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String RESOLVED_TO </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;RESOLVED_TO&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TAGGED_BY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TAGGED_BY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TAINT_REMOVE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TAINT_REMOVE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VTABLE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VTABLE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
</span></pre><h6 id="2-3-2-node-key">2.3.2 Node Key</h6>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ALIAS_TYPE_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ALIAS_TYPE_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ARGUMENT_INDEX </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ARGUMENT_INDEX&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String AST_PARENT_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;AST_PARENT_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String AST_PARENT_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;AST_PARENT_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String BINARY_SIGNATURE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;BINARY_SIGNATURE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CATEGORY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CATEGORY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CLASS_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CLASS_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CLOSURE_BINDING_ID </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CLOSURE_BINDING_ID&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CLOSURE_ORIGINAL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CLOSURE_ORIGINAL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CODE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CODE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String COLUMN_NUMBER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;COLUMN_NUMBER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String COLUMN_NUMBER_END </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;COLUMN_NUMBER_END&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CONTENT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CONTENT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DEPENDENCY_GROUP_ID </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DEPENDENCY_GROUP_ID&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DEPTH_FIRST_ORDER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DEPTH_FIRST_ORDER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DESCRIPTION </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DESCRIPTION&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DISPATCH_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DISPATCH_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String EVALUATION_STRATEGY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;EVALUATION_STRATEGY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String EVALUATION_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;EVALUATION_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FILENAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FILENAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FINGERPRINT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FINGERPRINT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String HAS_MAPPING </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;HAS_MAPPING&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String INHERITS_FROM_TYPE_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;INHERITS_FROM_TYPE_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IS_EXTERNAL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IS_EXTERNAL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IS_STATIC </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IS_STATIC&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LANGUAGE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LANGUAGE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LINE_NO </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LINE_NO&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LINE_NUMBER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LINE_NUMBER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LINE_NUMBER_END </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LINE_NUMBER_END&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LINK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LINK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LITERALS_TO_SINK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LITERALS_TO_SINK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_INST_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_INST_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_SHORT_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_SHORT_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String MODIFIER_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;MODIFIER_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String NODE_ID </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;NODE_ID&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String NODE_LABEL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;NODE_LABEL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ORDER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ORDER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PACKAGE_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PACKAGE_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PARAMETER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PARAMETER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PARAMETER_INDEX </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PARAMETER_INDEX&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PARSER_TYPE_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PARSER_TYPE_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PATH </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PATH&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PATTERN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PATTERN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String RESOLVED </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;RESOLVED&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SCC_ID </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SCC_ID&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SCORE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SCORE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SIGNATURE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SIGNATURE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SINK_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SINK_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SOURCE_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SOURCE_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SPID </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SPID&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SYMBOL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SYMBOL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TITLE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TITLE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE_DECL_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE_DECL_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE_FULL_NAME </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE_FULL_NAME&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VALUE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VALUE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VAR_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VAR_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VERSION </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VERSION&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VULN_DESCR </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VULN_DESCR&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
</span></pre><h6 id="2-3-3-node-type">2.3.3 Node Type</h6>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION_LITERAL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION_LITERAL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION_PARAMETER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION_PARAMETER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ANNOTATION_PARAMETER_ASSIGN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ANNOTATION_PARAMETER_ASSIGN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ARRAY_INITIALIZER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ARRAY_INITIALIZER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String BLOCK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;BLOCK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL_CHAIN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL_CHAIN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CALL_SITE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CALL_SITE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CLOSURE_BINDING </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CLOSURE_BINDING&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String COMMENT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;COMMENT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String CONFIG_FILE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;CONFIG_FILE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DEPENDENCY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DEPENDENCY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String DETACHED_TRACKING_POINT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;DETACHED_TRACKING_POINT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FILE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FILE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FINDING </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FINDING&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FLOW </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FLOW&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FRAMEWORK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FRAMEWORK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String FRAMEWORK_DATA </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;FRAMEWORK_DATA&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IDENTIFIER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IDENTIFIER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String IOFLOW </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;IOFLOW&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LITERAL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LITERAL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LOCAL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LOCAL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String LOCATION </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;LOCATION&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String MATCH_INFO </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;MATCH_INFO&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String MEMBER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;MEMBER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String META_DATA </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;META_DATA&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_INST </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_INST&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_PARAMETER_IN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_PARAMETER_IN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_PARAMETER_OUT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_PARAMETER_OUT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_REF </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_REF&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_RETURN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_RETURN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String METHOD_SUMMARY </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;METHOD_SUMMARY&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String MODIFIER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;MODIFIER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String NAMESPACE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;NAMESPACE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String NAMESPACE_BLOCK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;NAMESPACE_BLOCK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PROGRAM_POINT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PROGRAM_POINT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String READ </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;READ&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String RETURN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;RETURN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String ROUTE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;ROUTE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SENSITIVE_DATA_TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SENSITIVE_DATA_TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SENSITIVE_MEMBER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SENSITIVE_MEMBER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SENSITIVE_REFERENCE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SENSITIVE_REFERENCE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SENSITIVE_VARIABLE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SENSITIVE_VARIABLE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SINK </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SINK&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SOURCE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SOURCE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SP_ANNOTATION_PARAMETER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SP_ANNOTATION_PARAMETER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String SP_BLACKLIST </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;SP_BLACKLIST&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TAG </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TAG&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TAGS </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TAGS&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TAG_NODE_PAIR </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TAG_NODE_PAIR&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TRANSFORM </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TRANSFORM&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TRANSFORMATION </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TRANSFORMATION&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE_ARGUMENT </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE_ARGUMENT&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE_DECL </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE_DECL&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String TYPE_PARAMETER </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;TYPE_PARAMETER&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String UNKNOWN </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;UNKNOWN&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String VARIABLE_INFO </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;VARIABLE_INFO&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String WRITE </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;WRITE&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String PACKAGE_PREFIX </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;PACKAGE_PREFIX&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
</span></pre>
<p>######　2.3.4 Ｏperator</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> addition </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.addition&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> subtraction </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.subtraction&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> multiplication </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.multiplication&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> division </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.division&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> exponentiation </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.exponentiation&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> modulo </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.modulo&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> shiftLeft </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.shiftLeft&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> logicalShiftRight </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.logicalShiftRight&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> arithmeticShiftRight </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.arithmeticShiftRight&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> not </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.not&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> and </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.and&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> or </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.or&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> xor </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.xor&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentPlus </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.assignmentPlus&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentMinus </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.assignmentMinus&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentMultiplication </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.assignmentMultiplication&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentDivision </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.assignmentDivision&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentExponentiation </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentExponentiation&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentModulo </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentModulo&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentShiftLeft </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentShiftLeft&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentLogicalShifRight </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentLogicalShifRight&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentArithmeticShiftRight </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentArithmeticShiftRight&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentAnd </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentAnd&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentOr </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentOr&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignmentXor </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operators&gt;.assignmentXor&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> assignment </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.assignment&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> minus </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.minus&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> plus </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.plus&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> preIncrement </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.preIncrement&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> preDecrement </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.preDecrement&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> postIncrement </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.postIncrement&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> postDecrement </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.postDecrement&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> logicalNot </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.logicalNot&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> logicalOr </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.logicalOr&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> logicalAnd </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.logicalAnd&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> equals </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.equals&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> notEquals </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.notEquals&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> greaterThan </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.greaterThan&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> lessThan </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.lessThan&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> greaterEqualsThan </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.greaterEqualsThan&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> lessEqualsThan </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.lessEqualsThan&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> instanceOf </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.instanceOf&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> memberAccess </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.memberAccess&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> indirectMemberAccess </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.indirectMemberAccess&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> computedMemberAccess </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.computedMemberAccess&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> indirectComputedMemberAccess </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.indirectComputedMemberAccess&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> indirection </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.indirection&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> delete </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.delete&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> conditional </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.conditional&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> cast </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.cast&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> compare </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.compare&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> addressOf </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.addressOf&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
public static </span><span style="color:#8959a8;">final </span><span style="color:#f07219;">String</span><span style="color:#111111;"> sizeOf </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">&quot;&lt;operator&gt;.sizeOf&quot;</span><span style="color:#111111;">;</span><span style="color:#111111;">
</span></pre><h6 id="2-3-5-kai-yuan-ban-de-validation">2.3.5 开源版的validation</h6>
<p>用来验证导入的cpg是否正确</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">FILE</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">NAMESPACE_BLOCK</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_RETURN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_IN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MODIFIER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">BLOCK</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_PARAMETER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">ANNOTATION</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_IN</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">ANNOTATION</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_ARGUMENT</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_DECL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_PARAMETER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_DECL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MEMBER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_DECL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MODIFIER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_DECL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">ANNOTATION</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_DECL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">VTABLE</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MEMBER</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">ANNOTATION</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MEMBER</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">MODIFIER</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">LITERAL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_RETURN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CALL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CALL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_RETURN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CALL</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">RECEIVER</span><span style="color:#111111;"> to</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CALL</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">IDENTIFIER</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">LITERAL</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_REF</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">BLOCK</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">IDENTIFIER</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">IDENTIFIER</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REF</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">LOCAL</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_IN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">RETURN</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">RETURN</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_RETURN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">BLOCK</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">BLOCK</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">LOCAL</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">BLOCK</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_RETURN</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_INST</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">TYPE_ARGUMENT</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_REF</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;"> to </span><span style="color:#f07219;">SuperTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">Expression</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_REF</span><span style="color:#111111;"> has </span><span style="color:#f07219;">0</span><span style="color:#111111;"> to </span><span style="color:#f07219;">N</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CAPTURE</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CLOSURE_BINDING</span><span style="color:#111111;">,</span><span style="color:#111111;">
</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CLOSURE_BINDING</span><span style="color:#111111;"> has </span><span style="color:#f07219;">1</span><span style="color:#111111;"> outgoing </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REF</span><span style="color:#111111;"> to </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">LOCAL</span><span style="color:#111111;"> or </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_IN</span><span style="color:#111111;">
</span></pre><h6 id="2-3-6-bian-de-zuo-yong">2.3.6 边的作用</h6>
<p>打x表示开源版未用到（有些是定义了没用到）</p>
<table><thead><tr><th>Edge</th><th>作用</th><th>涉及的算法</th></tr></thead><tbody>
<tr><td>ALIAS_OF</td><td>Alias relation between types，link时生成</td><td></td></tr>
<tr><td>AST</td><td>AST转换成CPG的时候生成的边，标志AST关系</td><td></td></tr>
<tr><td>ATTACHED_DATA</td><td>x</td><td></td></tr>
<tr><td>BINDS_TO</td><td>Type argument binding to a type parameter(x)</td><td></td></tr>
<tr><td>CALL</td><td>call-&gt;methodInst，A (method)-call</td><td></td></tr>
<tr><td>CALL_ARG</td><td>x</td><td></td></tr>
<tr><td>CALL_ARG_OUT</td><td>x</td><td></td></tr>
<tr><td>CAPTURE</td><td>Connection between a captured LOCAL and the corresponding CLOSURE_BINDING（x）</td><td></td></tr>
<tr><td>CDG</td><td>x</td><td></td></tr>
<tr><td>CFG</td><td>Control Flow Graph</td><td>见CFG</td></tr>
<tr><td>CONTAINS</td><td>Shortcut over multiple AST edges，比如block下面包含的所有statement都会有一条CONTAINS边</td><td>遍历就完事</td></tr>
<tr><td>CONTAINS_NODE</td><td>Membership relation for a compound object（x）</td><td></td></tr>
<tr><td>DOMINATE</td><td>x</td><td></td></tr>
<tr><td>EVAL_TYPE</td><td>Link to evaluation type，对应各种类型的节点到TYPE节点</td><td></td></tr>
<tr><td>INHERITS_FROM</td><td>Inheritance relation between types</td><td></td></tr>
<tr><td>IS_SENSITIVE_DATA_DESCR_OF</td><td>x</td><td></td></tr>
<tr><td>IS_SENSITIVE_DATA_DESCR_OF_REF</td><td>x</td><td></td></tr>
<tr><td>IS_SENSITIVE_DATA_OF_TYPE</td><td>x</td><td></td></tr>
<tr><td>PARAMETER_LINK</td><td>Links together corresponding METHOD_PARAMETER_IN and METHOD_PARAMETER_OUT nodes</td><td></td></tr>
<tr><td>POST_DOMINATE</td><td>x</td><td></td></tr>
<tr><td>PROPAGATE</td><td>Encodes propagation of data from on node to another，这个边标志数据流的传播关系，人工定义，会在数据流分析中仔细分析</td><td></td></tr>
<tr><td>REACHING_DEF</td><td>Reaching definition edge，连接变量使用和定义位置，数据流分析的核心</td><td>Reaching Definition Analysis</td></tr>
<tr><td>RECEIVER</td><td>The receiver of a method call which is either an object or a pointer(x)</td><td></td></tr>
<tr><td>REF</td><td>A reference to e.g. a LOCAL，在多个地方均会创建REF边，标志一种引用关系</td><td></td></tr>
<tr><td>RESOLVED_TO</td><td>x</td><td></td></tr>
<tr><td>TAGGED_BY</td><td>Edges from nodes to tags（x）</td><td></td></tr>
<tr><td>TAINT_REMOVE</td><td>x</td><td></td></tr>
<tr><td>VTABLE</td><td>Indicates that a method is part of the vtable of a certain type declaratio</td><td></td></tr>
</tbody></table>
<h4 id="4-hou-duan-shi-xian">4. 后端实现</h4>
<h5 id="4-1-call-graphfen-xi">4.1 call-graph分析</h5>
<p>joern未实现</p>
<h5 id="4-2-shu-ju-liu-fen-xi">4.2 数据流分析</h5>
<p>开源版数据流分析就一个Reaching Definition Analysis。该算法表述为</p>
<ul>
<li>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88d90a4df4dc3fd7d5f07094e1c86593b00e56c2" alt="{{\rm {REACH}}}_{{{\rm {in}}}}[S]=\bigcup {{p\in pred[S]}}{{\rm {REACH}}}{{{\rm {out}}}}[p]" /></p>
<p>​							<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc62c65a0828cf46b792d3a87e3cffc4161382f0" alt="{{\rm {REACH}}}{{{\rm {out}}}}[S]={{\rm {GEN}}}[S]\cup ({{\rm {REACH}}}{{{\rm {in}}}}[S]-{{\rm {KILL}}}[S])" /></p>
</li>
</ul>
<p>S指的CFG中的节点（粒度可粗可细，一般来说是用basic block作为S，但joern处理略有不同），REACH_in 指的是到达该节点的定义集合，Reach_out 指的是从该节点传递出去的定义，p是指S的前驱。</p>
<p>所以第一个公式很好理解，S的REACH_in 就是它前驱的REACH_out的并。</p>
<p>第二个公式就要先介绍一下GEN和KILL，举个例子</p>
<p>1: int a = 1;</p>
<p>2: a=2;</p>
<p>两个a分别用a_1和a_2表示</p>
<p>假如1和2属不同S，REACH_in[1] = ∅，REACH_out[1] = GEN[1]∪(REACH_in[1] - KILL[1]) = {a_1}∪{∅-{a_2}} = {a_1}</p>
<p>GEN代表生成的定义，比如赋值操作就是定义了一个变量。</p>
<p>然后看2，REACH_in[2] = REACH_out[1] =  {a_1}，注意下这里a_2和a_1同指向一个变量，所以a_2 kill 了a_1，道理很简单，接下来如果有a的使用，那么一定是使用的a_2而不是a_1，同时a_1也kill了a_2，如果控制流从2返回到1，那么很明显情况就倒过来了。在例子这个情况下 KILL[2] = {a_1}，然后可以算出REACH_out[2] = {a_2}，这个是比较简单的情况，然后结合joern来分析三条语句以上的情况。</p>
<p>假设我们有四条语句</p>
<p>S1: a = 1;       a_1</p>
<p>S2: b = a;       b_1 a_2</p>
<p>S3: a = 3;       a_3</p>
<p>S4: b = a;       b_2 a_4</p>
<p>还是老规矩先标号，然后按cpg的思路来分析，为了方便，这里去除了定义，这个a有可能是函数参数，也可能是一般变量</p>
<p>首先在cpg中什么操作都是method，这个图可以画成这样</p>
<h6 id="tu">图</h6>
<p>见附件的png</p>
<h6 id="kuang-jia">框架</h6>
<p>有了这个图就可以来看Reaching Definition的代码了。首先看一个大框架，基本和上面描述的算法相似</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">class </span><span style="color:#c99e00;">ReachingDefPass</span><span style="color:#111111;">(</span><span style="color:#f07219;">graph</span><span style="color:#111111;">: </span><span style="color:#c99e00;">ScalaGraph</span><span style="color:#111111;">) </span><span style="color:#8959a8;">extends </span><span style="color:#839c00;">CpgPass</span><span style="color:#111111;">(graph) {</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">var </span><span style="color:#111111;">dfHelper: </span><span style="color:#c99e00;">DataFlowFrameworkHelper </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">_</span><span style="color:#111111;">
</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">override def </span><span style="color:#4271ae;">run</span><span style="color:#111111;">(): </span><span style="color:#c99e00;">Iterator</span><span style="color:#111111;">[</span><span style="color:#c99e00;">DiffGraph</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">dstGraph </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">DiffGraph</span><span style="color:#111111;">()</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methods </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> graph.</span><span style="color:#f07219;">V</span><span style="color:#111111;">.hasLabel(</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;">).l</span><span style="color:#111111;">
</span><span style="color:#111111;">
    dfHelper </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">DataFlowFrameworkHelper</span><span style="color:#111111;">(graph)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    methods.foreach { </span><span style="color:#f07219;">method </span><span style="color:#8959a8;">=&gt; </span><span style="color:#8e908c;">// 对所有method分析</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">var </span><span style="color:#111111;">worklist </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">var </span><span style="color:#111111;">out </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]]().withDefaultValue(</span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()) </span><span style="color:#8e908c;">// in</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">var </span><span style="color:#111111;">in </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]]().withDefaultValue(</span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()) </span><span style="color:#8e908c;">// out</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">allCfgNodes </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.allCfgNodesOfMethod(method).toList</span><span style="color:#111111;">
</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">mapExpressionsGens </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> dfHelper.expressionsToGenMap(method).withDefaultValue(</span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()) </span><span style="color:#8e908c;">// 这边针对method中每个cfg节点生成gen（因为每个cfg节点的赋值操作由于call的原因，如果有，那么只可能有一个。也就不用考虑单个基本块的KILL问题-多条赋值语句可能会直接kill掉一些gen）</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">mapExpressionsKills </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> dfHelper.expressionsToKillMap(method).withDefaultValue(</span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()) </span><span style="color:#8e908c;">// 生成kill</span><span style="color:#111111;">
</span><span style="color:#111111;">
      </span><span style="color:#8e908c;">/*Initialize the OUT sets*/</span><span style="color:#111111;">
      allCfgNodes.foreach { cfgNode </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(mapExpressionsGens.contains(cfgNode)) {</span><span style="color:#111111;">
          out += cfgNode -&gt; mapExpressionsGens(cfgNode) </span><span style="color:#8e908c;">// 初始化out列表为gen，接下来就∪(in-kill)就行</span><span style="color:#111111;">
        }</span><span style="color:#111111;">
      }</span><span style="color:#111111;">
      </span><span style="color:#8e908c;">// worklist算法，就是那两个公式</span><span style="color:#111111;">
      worklist ++= allCfgNodes </span><span style="color:#111111;">
</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">while </span><span style="color:#111111;">(worklist.nonEmpty) {</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">var </span><span style="color:#111111;">currentCfgNode </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> worklist.head</span><span style="color:#111111;">
        worklist </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> worklist.tail</span><span style="color:#111111;">
</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">var </span><span style="color:#111111;">inSet </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()</span><span style="color:#111111;">
</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">cfgPredecessors </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> currentCfgNode.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">IN</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;">).asScala</span><span style="color:#111111;">
        cfgPredecessors.foreach { pred </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
          inSet ++= inSet.union(out(pred)) </span><span style="color:#8e908c;">// 公式1</span><span style="color:#111111;">
        }</span><span style="color:#111111;">
</span><span style="color:#111111;">
        in += currentCfgNode -&gt; inSet</span><span style="color:#111111;">
</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">oldSize </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> out(currentCfgNode).size</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">gens </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> mapExpressionsGens(currentCfgNode) </span><span style="color:#8e908c;">// 获取gens，那么其实前面都生成完了，只要获取当前节点的gen就行了</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">kills </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> mapExpressionsKills(currentCfgNode) </span><span style="color:#8e908c;">// 同理</span><span style="color:#111111;">
        out += currentCfgNode -&gt; gens.union(inSet.diff(kills)) </span><span style="color:#8e908c;">// 公式2</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">val </span><span style="color:#111111;">newSize </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> out(currentCfgNode).size</span><span style="color:#111111;">
</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(oldSize != newSize) </span><span style="color:#8e908c;">// 观察out有没有变化</span><span style="color:#111111;">
          worklist ++= currentCfgNode.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">CFG</span><span style="color:#111111;">).asScala.toList</span><span style="color:#111111;">
      }</span><span style="color:#111111;">
</span><span style="color:#111111;">
      addReachingDefEdge(dstGraph, method, out, in)  </span><span style="color:#8e908c;">// 利用in和out生成REACH_DEF边，构建define 和use 的关系</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#f07219;">Iterator</span><span style="color:#111111;">(dstGraph)</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>看完大体流程，就是三个核心部分，gen和kill怎么生成，然后addReachingDefEdge做了啥？</p>
<p>先看gen和kill。</p>
<h6 id="gen">gen</h6>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">expressionsToGenMap</span><span style="color:#111111;">(</span><span style="color:#f07219;">methodVertex</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#c99e00;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">/*genExpressions correspond to call assignment nodes*/</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">genExpressions </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> getExpressions(methodVertex) </span><span style="color:#8e908c;">//这里获取了method中的所有call expression，注意到所有操作都是method，这很自然（每个call都是一个单独的cfg节点）</span><span style="color:#111111;">
    genExpressions.map { genExpression </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
      genExpression -&gt; getGensOfExpression(genExpression) </span><span style="color:#8e908c;">// 对每个call expression生成 gen</span><span style="color:#111111;">
    }.toMap</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>继续看getGensOfExpression</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">getGensOfExpression</span><span style="color:#111111;">(</span><span style="color:#f07219;">expr</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">var </span><span style="color:#111111;">gens </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methodParamOutsOrder </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> callToMethodParamOut(expr)</span><span style="color:#111111;">
      .filter(</span><span style="color:#f07219;">methPO </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> methPO.edges(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">IN</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">PROPAGATE</span><span style="color:#111111;">).hasNext)</span><span style="color:#111111;">
      .map(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">ORDER</span><span style="color:#111111;">).toInt) </span><span style="color:#8e908c;">// 找到call对应的method的paramter out，然后找到有propagate边的节点对应的参数的位置（有点拗口）</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">identifierWithOrder </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
      filterArgumentIndex(expr.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">).asScala.toList, methodParamOutsOrder) </span><span style="color:#8e908c;">// 找到这个参数在call参数中的位置</span><span style="color:#111111;">
    gens ++= identifierWithOrder</span><span style="color:#111111;">
</span><span style="color:#111111;">
    gens</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>这么看就是paramterout的propagate边至关重要。可以看看它是怎么生成的</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">override def </span><span style="color:#4271ae;">run</span><span style="color:#111111;">(): </span><span style="color:#c99e00;">Iterator</span><span style="color:#111111;">[</span><span style="color:#c99e00;">DiffGraph</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    dstGraph </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">DiffGraph</span><span style="color:#111111;">()</span><span style="color:#111111;">
</span><span style="color:#111111;">
    semantics.elements.foreach { </span><span style="color:#f07219;">semantic </span><span style="color:#8959a8;">=&gt; </span><span style="color:#8e908c;">//semantics从哪来？？？</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methodOption </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
        graph.</span><span style="color:#f07219;">V</span><span style="color:#111111;">().hasLabel(</span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD</span><span style="color:#111111;">).has(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">FULL_NAME</span><span style="color:#111111;"> -&gt; semantic.methodFullName).headOption()</span><span style="color:#111111;">
</span><span style="color:#111111;">
      methodOption </span><span style="color:#8959a8;">match </span><span style="color:#111111;">{</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">case </span><span style="color:#f07219;">Some</span><span style="color:#111111;">(</span><span style="color:#f07219;">method</span><span style="color:#111111;">) </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
          addSelfDefSemantic(method, semantic.parameterIndex)</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">case </span><span style="color:#f07219;">None </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
      }</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#f07219;">Iterator</span><span style="color:#111111;">(dstGraph)</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>注意下这个addSelfDefSemantic</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">private def </span><span style="color:#4271ae;">addSelfDefSemantic</span><span style="color:#111111;">(</span><span style="color:#f07219;">method</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#f07219;">parameterIndex</span><span style="color:#111111;">: </span><span style="color:#8959a8;">Int</span><span style="color:#111111;">): </span><span style="color:#8959a8;">Unit </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">// From where the PROPAGATE edge is coming does not matter for the open source reachable by.</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">// Thus we let it start from the corresponding METHOD_PARAMETER_IN.</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">parameterInOption </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> method</span><span style="color:#111111;">
      .vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">)</span><span style="color:#111111;">
      .asScala</span><span style="color:#111111;">
      .find(</span><span style="color:#f07219;">node </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> node.label() == </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_IN</span><span style="color:#111111;"> &amp;&amp; node.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">ORDER</span><span style="color:#111111;">) == parameterIndex)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">parameterOutOption </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> method</span><span style="color:#111111;">
      .vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">)</span><span style="color:#111111;">
      .asScala</span><span style="color:#111111;">
      .find(</span><span style="color:#f07219;">node </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> node.label() == </span><span style="color:#f07219;">NodeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">METHOD_PARAMETER_OUT</span><span style="color:#111111;"> &amp;&amp; node.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">ORDER</span><span style="color:#111111;">) == parameterIndex)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    (parameterInOption, parameterOutOption) </span><span style="color:#8959a8;">match </span><span style="color:#111111;">{</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">case</span><span style="color:#111111;"> (</span><span style="color:#f07219;">Some</span><span style="color:#111111;">(</span><span style="color:#f07219;">parameterIn</span><span style="color:#111111;">), </span><span style="color:#f07219;">Some</span><span style="color:#111111;">(</span><span style="color:#f07219;">parameterOut</span><span style="color:#111111;">)) </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        addPropagateEdge(parameterIn, parameterOut, isAlias </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">false</span><span style="color:#111111;">)</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">case</span><span style="color:#111111;"> (</span><span style="color:#f07219;">None</span><span style="color:#111111;">, </span><span style="color:#c82728;">_</span><span style="color:#111111;">) </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        logger.warn(</span><span style="color:#4271ae;">s</span><span style="color:#839c00;">&quot;Could not find parameter </span><span style="color:#c82728;">$parameterIndex</span><span style="color:#839c00;"> of ${</span><span style="color:#111111;">method.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">FULL_NAME</span><span style="color:#111111;">)</span><span style="color:#839c00;">}.&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">case </span><span style="color:#c82728;">_ </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        logger.warn(</span><span style="color:#4271ae;">s</span><span style="color:#839c00;">&quot;Could not find output parameter </span><span style="color:#c82728;">$parameterIndex</span><span style="color:#839c00;"> of ${</span><span style="color:#111111;">method.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">FULL_NAME</span><span style="color:#111111;">)</span><span style="color:#839c00;">}.&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>就是对应的METHOD_PARAMETER_OUT和METHOD_PARAMETER_IN节点间连了一条对应参数index的边？？？那么还是上面那个问题semantics是哪来的。，这个semantics是自己定义的。</p>
<p>joern中有一个semantics loader</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">class </span><span style="color:#c99e00;">SemanticsLoader</span><span style="color:#111111;">(</span><span style="color:#f07219;">filename</span><span style="color:#111111;">: </span><span style="color:#c99e00;">String</span><span style="color:#111111;">) {</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">private val </span><span style="color:#111111;">logger </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">LogManager</span><span style="color:#111111;">.getLogger(getClass)</span><span style="color:#111111;">
</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">load</span><span style="color:#111111;">(): </span><span style="color:#c99e00;">Semantics </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">bufferedReader </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Source</span><span style="color:#111111;">.fromFile(filename)</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">var </span><span style="color:#111111;">lineNumber </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">0</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">try </span><span style="color:#111111;">{</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">semanticElements </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
        bufferedReader</span><span style="color:#111111;">
          .getLines()</span><span style="color:#111111;">
          .flatMap { line </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">parts </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> line.split(</span><span style="color:#839c00;">&quot;,&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(parts.size == </span><span style="color:#f07219;">2</span><span style="color:#111111;">) {</span><span style="color:#111111;">
              </span><span style="color:#8959a8;">try </span><span style="color:#111111;">{</span><span style="color:#111111;">
                </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methodFullName </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> parts(</span><span style="color:#f07219;">0</span><span style="color:#111111;">).trim</span><span style="color:#111111;">
                </span><span style="color:#8959a8;">val </span><span style="color:#111111;">parameterIndex </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> parts(</span><span style="color:#f07219;">1</span><span style="color:#111111;">).trim.toInt</span><span style="color:#111111;">
                lineNumber += </span><span style="color:#f07219;">1</span><span style="color:#111111;">
                </span><span style="color:#f07219;">Some</span><span style="color:#111111;">(</span><span style="color:#f07219;">Semantic</span><span style="color:#111111;">(methodFullName, parameterIndex))</span><span style="color:#111111;">
              } </span><span style="color:#8959a8;">catch </span><span style="color:#111111;">{</span><span style="color:#111111;">
                </span><span style="color:#8959a8;">case </span><span style="color:#c82728;">_</span><span style="color:#111111;">: </span><span style="color:#c99e00;">NumberFormatException </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
                  logFormatError(</span><span style="color:#839c00;">&quot;Argument index is not convertable to Int.&quot;</span><span style="color:#111111;">, lineNumber)</span><span style="color:#111111;">
                  </span><span style="color:#f07219;">None</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
</span><span style="color:#111111;">
            } </span><span style="color:#8959a8;">else </span><span style="color:#111111;">{</span><span style="color:#111111;">
              logFormatError(</span><span style="color:#839c00;">&quot;Invalid number of elements per line. Expected method name followed by argument index.&quot;</span><span style="color:#111111;">,</span><span style="color:#111111;">
                             lineNumber)</span><span style="color:#111111;">
              </span><span style="color:#f07219;">None</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
          .toList</span><span style="color:#111111;">
</span><span style="color:#111111;">
      </span><span style="color:#f07219;">Semantics</span><span style="color:#111111;">(semanticElements)</span><span style="color:#111111;">
    } </span><span style="color:#8959a8;">finally </span><span style="color:#111111;">{</span><span style="color:#111111;">
      bufferedReader.close()</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>这样通过指定method和参数index来暗示该在哪里添加propagate边。但我没找到对应的文件，但大概也能猜到了。类似赋值这种操作都会在对应参数的位置标上一条propagate边来表示它是存在这种赋值语义的。joern针对c的话也有可能会处理一些传入引用进去的函数，这样那个值就是可变的，也就是左值。这种情况会添加一条propagate边。上图我标红色的就是该边</p>
<p>那知道了propagate怎么生成的，接下来继续看</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">getGensOfExpression</span><span style="color:#111111;">(</span><span style="color:#f07219;">expr</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">var </span><span style="color:#111111;">gens </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]()</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methodParamOutsOrder </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> callToMethodParamOut(expr)</span><span style="color:#111111;">
      .filter(</span><span style="color:#f07219;">methPO </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> methPO.edges(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">IN</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">PROPAGATE</span><span style="color:#111111;">).hasNext)</span><span style="color:#111111;">
      .map(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.value2(</span><span style="color:#f07219;">NodeKeys</span><span style="color:#111111;">.</span><span style="color:#f07219;">ORDER</span><span style="color:#111111;">).toInt) </span><span style="color:#8e908c;">// 找到call对应的method的paramter out，然后找到有propagate边的节点对应的参数的位置（有点拗口）</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">//所以这里实际是获取了会发生变化的参数值</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">identifierWithOrder </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
      filterArgumentIndex(expr.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">).asScala.toList, methodParamOutsOrder) </span><span style="color:#8e908c;">// 找到这个参数在call参数中的位置</span><span style="color:#111111;">
    gens ++= identifierWithOrder </span><span style="color:#8e908c;">//把这个参数添加到gen。 </span><span style="color:#111111;">
</span><span style="color:#111111;">
    gens</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>比如赋值操作，那么它的第一个参数id会被放入gens。</p>
<p>gen分析完了，接下来分析kill</p>
<h6 id="kill">kill</h6>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">expressionsToKillMap</span><span style="color:#111111;">(</span><span style="color:#f07219;">methodVertex</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#c99e00;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">genExpressions </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> getExpressions(methodVertex) </span><span style="color:#8e908c;">// 获取call</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">genSet </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> getGenSet(methodVertex) </span><span style="color:#8e908c;">// 没用到。。。可能是typo</span><span style="color:#111111;">
</span><span style="color:#111111;">
    genExpressions.map { expression </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">gens </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> getGensOfExpression(expression)  </span><span style="color:#8e908c;">// 获取call的gen  </span><span style="color:#111111;">
      expression -&gt; kills(gens) </span><span style="color:#8e908c;">// kill</span><span style="color:#111111;">
    }.toMap</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>来看看这个核心的kill实现</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">killsVertices</span><span style="color:#111111;">(</span><span style="color:#f07219;">vertex</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">// vertex: gen(id)</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRefIt </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> vertex.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REF</span><span style="color:#111111;">).asScala </span><span style="color:#8e908c;">// 获取ref，那么id的ref就是local或者函数参数</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(!localRefIt.hasNext) {</span><span style="color:#111111;">
      </span><span style="color:#f07219;">Set</span><span style="color:#111111;">() </span><span style="color:#8e908c;">// 无</span><span style="color:#111111;">
    } </span><span style="color:#8959a8;">else </span><span style="color:#111111;">{</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRef </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> localRefIt.next</span><span style="color:#111111;">
      localRef.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">IN</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REF</span><span style="color:#111111;">).asScala.filter(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.id != vertex.id).toSet </span><span style="color:#8e908c;">// 查找所有进来的ref边，除去对应id的节点</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">kills</span><span style="color:#111111;">(</span><span style="color:#f07219;">vertex</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]): </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">] </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
    vertex.map(</span><span style="color:#f07219;">v </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> killsVertices(v)).fold(</span><span style="color:#f07219;">Set</span><span style="color:#111111;">())((</span><span style="color:#f07219;">v1</span><span style="color:#111111;">, </span><span style="color:#f07219;">v2</span><span style="color:#111111;">) </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> v1.union(v2))</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>这个可能有点难懂，配合图来看。结合GEN来整个的梳理一下</p>
<p>这个localRefIt就是a和b变量，这两个变量可能是local，也可能是函数的参数。（local是定义语句的情况）</p>
<p>首先对S1，KILL[S1] 首先找它的GEN，显然它的GEN是{a_1}，然后进到killsVertices，获取到REF，killsVertices的返回就是{a_2,a_3,a_4}，那么它的REACH_in[1] 就是 ∅， REACH_out[1] = {a_1} ∪(∅-{a_2,a_3,a_4}) = {a_1}</p>
<p>接下来看REACH_in[2] = {a_1}，然后算GEN[2]，注意这时候GEN涉及到两个变量，一个是b_1，一个是a_2。但a_2对应的index没有propagate边，所以这里GEN[2] = {b_1}，这时候算KILL[2] = {b_2}，REACH_out[2] = {b_1}∪({a_1} - {b_2}) = {a_1, b_1}</p>
<p>然后是REACH_in[3] = {a_1, b_1}, GEN[3] = {a_3}, KILL[3] = {a_1, a_2, a_4}, REACH_out[3] = {a_3}∪({a_1,b_1} - {a_1,a_2,a_4}) = {a_3,b_1}</p>
<p>同理REACH_in[4] = {a_3, b_1}, GEN[3] = {b_2}, KILL[4] = {b1}, REACH_out[3] = {b_2}∪({a_3,b_1} - {b_1}) = {a_3,b_2}</p>
<p>通过这样一个过程，基本就能把REACH_in和REACH_out都算出来</p>
<h6 id="reach-def">REACH_DEF</h6>
<p>注意下我们上面算出来的in和out都是针对单个cfg节点的，在cpg中就是单个call。这样很容易构造使用链。来看看开源版的实现(可能有点长) 传入的参数分别为method（当前分析的method），outset（每个cfg节点对应的out id），inset（每个cfg节点对应的in id）</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">private def </span><span style="color:#4271ae;">addReachingDefEdge</span><span style="color:#111111;">(</span><span style="color:#f07219;">dstGraph</span><span style="color:#111111;">: </span><span style="color:#c99e00;">DiffGraph</span><span style="color:#111111;">,</span><span style="color:#111111;">
                                 </span><span style="color:#f07219;">method</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">,</span><span style="color:#111111;">
                                 </span><span style="color:#f07219;">outSet</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]],</span><span style="color:#111111;">
                                 </span><span style="color:#f07219;">inSet</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Map</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#c99e00;">Set</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">]]): </span><span style="color:#8959a8;">Unit </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
	</span><span style="color:#8e908c;">// 添加Reachdef边</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">addEdge</span><span style="color:#111111;">(</span><span style="color:#f07219;">v0</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">, </span><span style="color:#f07219;">v1</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Vertex</span><span style="color:#111111;">): </span><span style="color:#8959a8;">Unit </span><span style="color:#3e999f;">= </span><span style="color:#111111;">{</span><span style="color:#111111;">
      dstGraph.addEdgeInOriginal(v0.asInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">StoredNode</span><span style="color:#111111;">],</span><span style="color:#111111;">
                                 v1.asInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">StoredNode</span><span style="color:#111111;">],</span><span style="color:#111111;">
                                 </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REACHING_DEF</span><span style="color:#111111;">)</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
    </span><span style="color:#8e908c;">// paramter def use</span><span style="color:#111111;">
    method.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">).asScala.filter(</span><span style="color:#c82728;">_</span><span style="color:#111111;">.isInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">MethodParameterIn</span><span style="color:#111111;">]).foreach {</span><span style="color:#111111;">
      methodParameterIn </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
        </span><span style="color:#8e908c;">// 对于每个method的参数，找到进来的ref，就是比如上面例子的a和b，如果他们是参数的话就会进到这。</span><span style="color:#111111;">
        methodParameterIn.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">IN</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">REF</span><span style="color:#111111;">).asScala.foreach { refInIdentifier </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
          dfHelper</span><span style="color:#111111;">
            .getOperation(refInIdentifier)</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 每个引用的method都加上 REACH_DEF</span><span style="color:#111111;">
            .foreach(</span><span style="color:#f07219;">operationNode </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> addEdge(methodParameterIn, operationNode))</span><span style="color:#111111;">
        }</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">methodReturn </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.methodToFormalReturn(method)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#111111;">
    </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">
      .formalReturnToReturn(methodReturn)</span><span style="color:#111111;">
       </span><span style="color:#8e908c;">// method 的返回节点和methodReturn也需要建立REACH_DEF边</span><span style="color:#111111;">
      .foreach(</span><span style="color:#f07219;">returnVertex </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> addEdge(returnVertex, methodReturn))</span><span style="color:#111111;">
</span><span style="color:#111111;">
    outSet.foreach {</span><span style="color:#111111;">
      </span><span style="color:#8e908c;">// 例子里的node都是call，outDefs都是id</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">case</span><span style="color:#111111;"> (</span><span style="color:#f07219;">node</span><span style="color:#111111;">, </span><span style="color:#f07219;">outDefs</span><span style="color:#111111;">) </span><span style="color:#3e999f;">=&gt;</span><span style="color:#111111;">
        </span><span style="color:#8e908c;">// 最常见的是call</span><span style="color:#111111;">
        </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(node.isInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Call</span><span style="color:#111111;">]) {</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">// 注意这边拿use了，其实也很简单，去掉gen的部分就都是use，就比如例子中的a_2, a_4, 它们就是use</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">/*</span><span style="color:#8e908c;">
            def getUsesOfExpression(expr: Vertex): Set[Vertex] = {</span><span style="color:#8e908c;">
                expr</span><span style="color:#8e908c;">
                  .vertices(Direction.OUT, EdgeTypes.AST)</span><span style="color:#8e908c;">
                  .asScala</span><span style="color:#8e908c;">
                  .filter(!getGensOfExpression(expr).contains(_))</span><span style="color:#8e908c;">
                  .toSet</span><span style="color:#8e908c;">
              }</span><span style="color:#8e908c;">
          */</span><span style="color:#111111;">
          </span><span style="color:#8959a8;">val </span><span style="color:#111111;">usesInExpression </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> dfHelper.getUsesOfExpression(node)</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">// 获取use的ref</span><span style="color:#111111;">
          </span><span style="color:#8959a8;">var </span><span style="color:#111111;">localRefsUses </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> usesInExpression.map(</span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(</span><span style="color:#c82728;">_</span><span style="color:#111111;">)).filter(</span><span style="color:#c82728;">_</span><span style="color:#111111;"> != </span><span style="color:#f07219;">None</span><span style="color:#111111;">)</span><span style="color:#111111;">
</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">/* if use is not an identifier, add edge, as we are going to visit the use separately */</span><span style="color:#111111;">
          usesInExpression.foreach { use </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(!use.isInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Identifier</span><span style="color:#111111;">] &amp;&amp; !use.isInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Literal</span><span style="color:#111111;">]) {</span><span style="color:#111111;">
              </span><span style="color:#8e908c;">// 特殊情况</span><span style="color:#111111;">
              addEdge(use, node)</span><span style="color:#111111;">
</span><span style="color:#111111;">
              </span><span style="color:#8e908c;">/* handle indirect access uses: check if we have it in our out set and get</span><span style="color:#8e908c;">
               * the corresponding def expression from which the definition reaches the use</span><span style="color:#8e908c;">
               */</span><span style="color:#111111;">
              </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(isIndirectAccess(use)) {</span><span style="color:#111111;">
                outDefs.filter(</span><span style="color:#f07219;">out </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> isIndirectAccess(out)).foreach { indirectOutDef </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
                  </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(indirectOutDef.asInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Call</span><span style="color:#111111;">].code == use.asInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Call</span><span style="color:#111111;">].code) {</span><span style="color:#111111;">
                    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">expandedToCall </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.argumentToCallOrReturn(indirectOutDef)</span><span style="color:#111111;">
                    addEdge(expandedToCall, use)</span><span style="color:#111111;">
                  }</span><span style="color:#111111;">
                }</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">// operate or assignment 处理类似+=的操作，注意+= 数据流并不是中断了的！！！</span><span style="color:#111111;">
          </span><span style="color:#8959a8;">val </span><span style="color:#111111;">nodeIsOperandAssignment </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> isOperationAndAssignment(node)</span><span style="color:#111111;">
          </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(nodeIsOperandAssignment) {</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// localRef，什么意思呢，先获取gen的ref，然后看看gen的ref包不包含inset中的元素，因为这边要维护数据流，也算一种特殊情况，这条REACH_DEF边都是gen产生的</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRefGens </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> dfHelper.getGensOfExpression(node).map(</span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(</span><span style="color:#c82728;">_</span><span style="color:#111111;">))</span><span style="color:#111111;">
            inSet(node)</span><span style="color:#111111;">
              .filter(</span><span style="color:#f07219;">inElement </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> localRefGens.contains(</span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(inElement)))</span><span style="color:#111111;">
              .foreach { filteredInElement </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
                </span><span style="color:#8e908c;">// 两个call之间会有一条REACH_DEF边</span><span style="color:#111111;">
                </span><span style="color:#8959a8;">val </span><span style="color:#111111;">expr </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> dfHelper.getExpressionFromGen(filteredInElement).foreach(addEdge(</span><span style="color:#c82728;">_</span><span style="color:#111111;">, node))</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
          </span><span style="color:#8959a8;">for</span><span style="color:#111111;"> (</span><span style="color:#f07219;">elem </span><span style="color:#3e999f;">&lt;-</span><span style="color:#111111;"> outDefs) {</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 遍历每个out id，找到ref</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRefGen </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(elem)</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 通过ast找到每个out id的call</span><span style="color:#111111;">
            dfHelper.getExpressionFromGen(elem).foreach { expressionOfElement </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
              </span><span style="color:#8e908c;">// 对于每个不是自己的call，如果use ref中包含out id的ref(用了！)，那就添加REACH_DEF边</span><span style="color:#111111;">
              </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(expressionOfElement != node &amp;&amp; localRefsUses.contains(localRefGen)) {</span><span style="color:#111111;">
                addEdge(expressionOfElement, node)</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
        } </span><span style="color:#8959a8;">else if </span><span style="color:#111111;">(node.isInstanceOf[</span><span style="color:#c99e00;">nodes</span><span style="color:#111111;">.</span><span style="color:#c99e00;">Return</span><span style="color:#111111;">]) {</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">// return is special case</span><span style="color:#111111;">
          </span><span style="color:#8e908c;">// 如果返回值，那么返回的Expression中也会有指向对应id的REACH_DEF边</span><span style="color:#111111;">
          node.vertices(</span><span style="color:#f07219;">Direction</span><span style="color:#111111;">.</span><span style="color:#f07219;">OUT</span><span style="color:#111111;">, </span><span style="color:#f07219;">EdgeTypes</span><span style="color:#111111;">.</span><span style="color:#f07219;">AST</span><span style="color:#111111;">).asScala.foreach { returnExpr </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRef </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(returnExpr)</span><span style="color:#111111;">
            inSet(node).filter(</span><span style="color:#f07219;">inElement </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> localRef == </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(inElement)).foreach { filteredInElement </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
              dfHelper.getExpressionFromGen(filteredInElement).foreach(addEdge(</span><span style="color:#c82728;">_</span><span style="color:#111111;">, node))</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
        }</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span></pre>
<p>这就是整个REACH_DEF了，从参数开始一直到返回值，中间涉及到很多call，这就是整个的数据流框架。</p>
<p>就我们的例子看</p>
<p>S1: a = 1;       a_1</p>
<p>S2: b = a;       b_1 a_2</p>
<p>S3: a = 3;       a_3</p>
<p>S4: b = a;       b_2 a_4</p>
<p>S1 REACH_in[1] = ∅ , GEN:{a_1}，KILL:{a_2,a_3,a_4}， REACH_out[1] = {a_1} ∪(∅-{a_2,a_3,a_4}) = {a_1}</p>
<p>S2 REACH_in[2] = {a_1}，GEN[2] = {b_1}，KILL[2] = {b_2}，REACH_out[2] = {b_1}∪({a_1} - {b_2}) = {a_1, b_1}</p>
<p>S3 REACH_in[3] = {a_1, b_1}, GEN[3] = {a_3}, KILL[3] = {a_1, a_2, a_4}, REACH_out[3] = {a_3}∪({a_1,b_1} - {a_1,a_2,a_4}) = {a_3,b_1}</p>
<p>S4 REACH_in[4] = {a_3, b_1}, GEN[3] = {b_2}, KILL[4] = {b1}, REACH_out[4] = {b_2}∪({a_3,b_1} - {b_1}) = {a_3,b_2}</p>
<p>那么分析从获取use开始</p>
<p>S1: ∅</p>
<p>S2: {a}</p>
<p>S3: ∅</p>
<p>S4: {a}</p>
<p>然后遍历outSet</p>
<p>S1 不会发生啥</p>
<p>S2 进到分支 </p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">          </span><span style="color:#8959a8;">for</span><span style="color:#111111;"> (</span><span style="color:#f07219;">elem </span><span style="color:#3e999f;">&lt;-</span><span style="color:#111111;"> outDefs) {</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 遍历每个out id，找到ref</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRefGen </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(elem)</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 通过ast找到每个out id的call</span><span style="color:#111111;">
            dfHelper.getExpressionFromGen(elem).foreach { expressionOfElement </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
              </span><span style="color:#8e908c;">// 对于每个不是自己的call，如果use ref中包含out id的ref(用了！)，那就添加REACH_DEF边</span><span style="color:#111111;">
              </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(expressionOfElement != node &amp;&amp; localRefsUses.contains(localRefGen)) {</span><span style="color:#111111;">
                addEdge(expressionOfElement, node)</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
</span></pre>
<p>REACH_out[2] = {a_1, b_1}， localRefGens = [{a}, {b}]</p>
<p>expressionOfElement = {S1, S2}, node = S2。localRefGens[1] ∈ localRefsUses = {a}</p>
<p>addEdge(S1, S2)</p>
<p>S3 没进分支</p>
<p>S4 还是进到分支</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">          </span><span style="color:#8959a8;">for</span><span style="color:#111111;"> (</span><span style="color:#f07219;">elem </span><span style="color:#3e999f;">&lt;-</span><span style="color:#111111;"> outDefs) {</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 遍历每个out id，找到ref</span><span style="color:#111111;">
            </span><span style="color:#8959a8;">val </span><span style="color:#111111;">localRefGen </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">ExpandTo</span><span style="color:#111111;">.reference(elem)</span><span style="color:#111111;">
            </span><span style="color:#8e908c;">// 通过ast找到每个out id的call</span><span style="color:#111111;">
            dfHelper.getExpressionFromGen(elem).foreach { expressionOfElement </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
              </span><span style="color:#8e908c;">// 对于每个不是自己的call，如果use ref中包含out id的ref(用了！)，那就添加REACH_DEF边</span><span style="color:#111111;">
              </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(expressionOfElement != node &amp;&amp; localRefsUses.contains(localRefGen)) {</span><span style="color:#111111;">
                addEdge(expressionOfElement, node)</span><span style="color:#111111;">
              }</span><span style="color:#111111;">
            }</span><span style="color:#111111;">
          }</span><span style="color:#111111;">
</span></pre>
<p>REACH_out[4] = {a_3,b_2}， localRefGens = [{a}, {b}]</p>
<p>expressionOfElement = {S3, S4}, node = S4。localRefGens[1] ∈ localRefsUses = {a}</p>
<p>addEdge(S3, S4)</p>
<p>所以综上S1到S2会有一条，S3到S4会有一条，暗示定义和使用的关系</p>
<p>那么数据流就到这了，剩下就是递归遍历就能找到定义和使用的地方以及进过的call和method</p>
<h5 id="4-3-shu-ju-cun-chu">4.3 数据存储</h5>
<p>图数据库，这个先放放</p>
<h5 id="4-4-cha-xun">4.4 查询</h5>
<p>数据查询官方给的几种方法：</p>
<p>https://github.com/ShiftLeftSecurity/codepropertygraph</p>
<p>其中列了很多类型：</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">cpg.literal.toList</span><span style="color:#111111;">
cpg.file.toList</span><span style="color:#111111;">
cpg.namespace.toList</span><span style="color:#111111;">
cpg.types.toList</span><span style="color:#111111;">
cpg.methodReturn.toList</span><span style="color:#111111;">
cpg.parameter.toList</span><span style="color:#111111;">
cpg.member.toList</span><span style="color:#111111;">
cpg.call.toList</span><span style="color:#111111;">
cpg.local.toList</span><span style="color:#111111;">
cpg.identifier.toList</span><span style="color:#111111;">
cpg.argument.toList</span><span style="color:#111111;">
cpg.typeDecl.toList</span><span style="color:#111111;">
cpg.method.toList</span><span style="color:#111111;">
cpg.methodInstance.toList</span><span style="color:#111111;">
</span></pre>
<p>查询有两种方式。一种是形如 </p>
<blockquote>
<p>./joern-query -f ./foo.scala</p>
</blockquote>
<p>这个-f用来加载一个scala文件，其中foo.scala被安置于一个上下文：</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">cpg.file.name.l.mkString(</span><span style="color:#839c00;">&quot;</span><span style="color:#f07219;">\n</span><span style="color:#839c00;">&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
</span></pre>
<p>其实有点类似spark-shell，cpg代表以及load到内存中的cpg，用这个作为起点，最后返回值取最后一次eval的值，比如</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">cpg.file.name.l.mkString(&quot;\n&quot;)</span><span style="color:#111111;">
&quot;a&quot;</span><span style="color:#111111;">
</span></pre>
<p>等执行完就会输出a。</p>
<p>另一种查询方式如</p>
<blockquote>
<p>./joern-query -c cpg.file.name</p>
</blockquote>
<p>这种方式的查询他们还搞了一大堆插件，其实都一样，其实就是拼接了一下而已：</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">package </span><span style="color:#111111;">io.shiftleft.joern</span><span style="color:#111111;">
</span><span style="color:#111111;">
</span><span style="color:#8959a8;">import </span><span style="color:#c82728;">java.io.FileReader</span><span style="color:#111111;">
</span><span style="color:#8959a8;">import </span><span style="color:#c82728;">javax.script.ScriptEngineManager</span><span style="color:#111111;">
</span><span style="color:#111111;">
</span><span style="color:#8959a8;">object </span><span style="color:#c99e00;">JoernQuery </span><span style="color:#8959a8;">extends </span><span style="color:#839c00;">App </span><span style="color:#111111;">{</span><span style="color:#111111;">
</span><span style="color:#111111;">
  parseConfig.foreach { config </span><span style="color:#3e999f;">=</span><span style="color:#111111;">&gt;</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">e </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">ScriptEngineManager</span><span style="color:#111111;">().getEngineByName(</span><span style="color:#839c00;">&quot;scala&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">cpgLoadingCode </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
      </span><span style="color:#4271ae;">s</span><span style="color:#839c00;">&quot;&quot;&quot;</span><span style="color:#839c00;">
      | import io.shiftleft.joern.CpgLoader</span><span style="color:#839c00;">
      | import io.shiftleft.codepropertygraph.Cpg</span><span style="color:#839c00;">
      | val cpg : Cpg = CpgLoader.load(&quot;${</span><span style="color:#111111;">config.cpgFilename</span><span style="color:#839c00;">}&quot;)</span><span style="color:#839c00;">
      |&quot;&quot;&quot;</span><span style="color:#111111;">.stripMargin</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">val </span><span style="color:#111111;">context </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> e.getContexta</span><span style="color:#111111;">
    e.eval(cpgLoadingCode, context)</span><span style="color:#111111;">
</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">if </span><span style="color:#111111;">(config.isFile) {</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">reader </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">FileReader</span><span style="color:#111111;">(config.query)</span><span style="color:#111111;">
      println(e.eval(reader, context))</span><span style="color:#111111;">
    } </span><span style="color:#8959a8;">else </span><span style="color:#111111;">{</span><span style="color:#111111;">
      </span><span style="color:#8959a8;">val </span><span style="color:#111111;">script </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> config.query + </span><span style="color:#839c00;">&quot;.l.mkString(</span><span style="color:#f07219;">\&quot;\\</span><span style="color:#839c00;">n</span><span style="color:#f07219;">\&quot;</span><span style="color:#839c00;">)&quot;</span><span style="color:#111111;">
      println(e.eval(script, context))</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
  }</span><span style="color:#111111;">
</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">case class </span><span style="color:#c99e00;">Config</span><span style="color:#111111;">(</span><span style="color:#f07219;">cpgFilename</span><span style="color:#111111;">: </span><span style="color:#c99e00;">String</span><span style="color:#111111;">, </span><span style="color:#f07219;">query</span><span style="color:#111111;">: </span><span style="color:#c99e00;">String</span><span style="color:#111111;">, </span><span style="color:#f07219;">isFile</span><span style="color:#111111;">: </span><span style="color:#8959a8;">Boolean </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">false</span><span style="color:#111111;">)</span><span style="color:#111111;">
  </span><span style="color:#8959a8;">def </span><span style="color:#4271ae;">parseConfig</span><span style="color:#111111;">: </span><span style="color:#c99e00;">Option</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Config</span><span style="color:#111111;">] </span><span style="color:#3e999f;">=</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">new </span><span style="color:#c99e00;">scopt</span><span style="color:#111111;">.</span><span style="color:#c99e00;">OptionParser</span><span style="color:#111111;">[</span><span style="color:#c99e00;">Config</span><span style="color:#111111;">](</span><span style="color:#839c00;">&quot;joern-query&quot;</span><span style="color:#111111;">) {</span><span style="color:#111111;">
      opt[</span><span style="color:#c99e00;">String</span><span style="color:#111111;">](</span><span style="color:#f07219;">&#39;c&#39;</span><span style="color:#111111;">, </span><span style="color:#839c00;">&quot;cpg&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .text(</span><span style="color:#839c00;">&quot;the code property graph to run queries on (default: cpg.bin.zip)&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .action((</span><span style="color:#f07219;">x</span><span style="color:#111111;">, </span><span style="color:#f07219;">c</span><span style="color:#111111;">) </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> c.copy(cpgFilename </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> x))</span><span style="color:#111111;">
      arg[</span><span style="color:#c99e00;">String</span><span style="color:#111111;">](</span><span style="color:#839c00;">&quot;&lt;query|filename&gt;&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .text(</span><span style="color:#839c00;">&quot;query to execute, or script file to execute if -f is set&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .action((</span><span style="color:#f07219;">x</span><span style="color:#111111;">, </span><span style="color:#f07219;">c</span><span style="color:#111111;">) </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> c.copy(query </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> x))</span><span style="color:#111111;">
      opt[</span><span style="color:#8959a8;">Unit</span><span style="color:#111111;">](</span><span style="color:#f07219;">&#39;f&#39;</span><span style="color:#111111;">, </span><span style="color:#839c00;">&quot;isFile&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .text(</span><span style="color:#839c00;">&quot;if specified, the second parameter is assumed to be a script file&quot;</span><span style="color:#111111;">)</span><span style="color:#111111;">
        .action((</span><span style="color:#c82728;">_</span><span style="color:#111111;">, </span><span style="color:#f07219;">c</span><span style="color:#111111;">) </span><span style="color:#8959a8;">=&gt;</span><span style="color:#111111;"> c.copy(isFile </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">true</span><span style="color:#111111;">))</span><span style="color:#111111;">
    }.parse(args, </span><span style="color:#f07219;">Config</span><span style="color:#111111;">(</span><span style="color:#839c00;">&quot;cpg.bin.zip&quot;</span><span style="color:#111111;">, </span><span style="color:#839c00;">&quot;&quot;</span><span style="color:#111111;">))</span><span style="color:#111111;">
</span><span style="color:#111111;">
}</span><span style="color:#111111;">
</span><span style="color:#111111;">
</span></pre>
<p>就像这样，所以这边实际就是可以根据它提供的cpg自己写scala处理</p>
<p>io.shiftleft.codepropertygraph.Cpg 也就是这个类</p>
<p>来看看</p>
<p>源码：</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#8959a8;">#include </span><span style="color:#839c00;">&lt;stdlib.h&gt;</span><span style="color:#111111;">
</span><span style="color:#8959a8;">struct </span><span style="color:#111111;">node {</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">int</span><span style="color:#111111;"> value;</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">struct </span><span style="color:#111111;">node *next;</span><span style="color:#111111;">
};</span><span style="color:#111111;">
</span><span style="color:#111111;">
</span><span style="color:#8959a8;">void </span><span style="color:#4271ae;">free_list</span><span style="color:#111111;">(</span><span style="color:#8959a8;">struct</span><span style="color:#111111;"> node </span><span style="color:#3e999f;">*</span><span style="color:#f07219;">head</span><span style="color:#111111;">) {</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">struct</span><span style="color:#111111;"> node </span><span style="color:#3e999f;">*</span><span style="color:#111111;">q;</span><span style="color:#111111;">
    </span><span style="color:#8959a8;">for </span><span style="color:#111111;">(</span><span style="color:#8959a8;">struct</span><span style="color:#111111;"> node </span><span style="color:#3e999f;">*</span><span style="color:#111111;">p </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> head; p </span><span style="color:#3e999f;">!= </span><span style="color:#f07219;">NULL</span><span style="color:#111111;">; p </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> q) {</span><span style="color:#111111;">
        q </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> p-&gt;next;</span><span style="color:#111111;">
        </span><span style="color:#4271ae;">free(p)</span><span style="color:#111111;">;</span><span style="color:#111111;">
    }</span><span style="color:#111111;">
}</span><span style="color:#111111;">
</span></pre>
<p>使用cpg.method.name.toSet查询</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">
</span><span style="color:#f07219;">Set</span><span style="color:#111111;">(free_list, </span><span style="color:#5d9be5;">&lt;</span><span style="color:#c82728;">operator</span><span style="color:#5d9be5;">&gt;</span><span style="color:#111111;">.indirectMemberAccess, </span><span style="color:#5d9be5;">&lt;</span><span style="color:#c82728;">operator</span><span style="color:#5d9be5;">&gt;</span><span style="color:#111111;">.notEquals, </span><span style="color:#5d9be5;">&lt;</span><span style="color:#c82728;">operator</span><span style="color:#5d9be5;">&gt;</span><span style="color:#111111;">.assignment, free)</span><span style="color:#111111;">
</span><span style="color:#111111;">
</span></pre>
<p>cpg.file.namespaceBlock.name.toSet</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#f07219;">Set</span><span style="color:#111111;">(</span><span style="color:#5d9be5;">&lt;</span><span style="color:#c82728;">global</span><span style="color:#5d9be5;">&gt;</span><span style="color:#111111;">)</span><span style="color:#111111;">
</span></pre>
<p>cpg.file.typeDecl.name.toSet</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#f07219;">Set</span><span style="color:#111111;">(node)</span><span style="color:#111111;">
</span></pre>
<p>cpg.method.name(&quot;free_list&quot;).parameter.name.toSet</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">Set(head)</span><span style="color:#111111;">
</span></pre>
<p>cpg.typeDecl.name.toSet</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#f07219;">Set</span><span style="color:#111111;">(</span><span style="color:#f07219;">ANY</span><span style="color:#111111;">, void, int, struct node *, node)</span><span style="color:#111111;">
</span></pre>
<p>cpg.method.name(&quot;free_list&quot;).local.name</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#f07219;">Set</span><span style="color:#111111;">(q, p)</span><span style="color:#111111;">
</span></pre>
<p>cpg.method.name(&quot;free_list&quot;).caller</p>
<p>call graph查找
查找调用者和被调用者(joern无法使用，但Ocular可以)</p>
<p>dataflow 分析
指定变量是否能到达控制流的某个点</p>
<p>指定一个souce，指定一个sink</p>
<pre style="background-color:#f9f9f9;">
<span style="color:#111111;">souce </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> cpg.method.fullName(</span><span style="color:#839c00;">&quot;.*Http.*&quot;</span><span style="color:#111111;">).methodReturn  </span><span style="color:#8e908c;">// 函数名符合该正则表达式的函数的返回值</span><span style="color:#111111;">
souce也可以是变量：</span><span style="color:#111111;">
souce </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> cpg.identifier</span><span style="color:#111111;">
sink </span><span style="color:#3e999f;">=</span><span style="color:#111111;"> cpg.method(</span><span style="color:#839c00;">&quot;xxx&quot;</span><span style="color:#111111;">).parameter</span><span style="color:#111111;">
</span><span style="color:#111111;">
sink.reachableBy(source).flows.passesNot(</span><span style="color:#839c00;">&quot;.*filter.*&quot;</span><span style="color:#111111;">).p </span><span style="color:#8e908c;">// 会打印出数据流，同时可以指定filter，用于可能会有的过滤函数</span><span style="color:#111111;">
</span></pre>
<p>目前来看就是最多就做到这样了。</p>

</div>

<div id="toc-container">
    <div id="blog-toc">
    <!--<div id="close-blog-toc"></div>-->
        <ul id="main-toc-list" class="toc-list">
            
                
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#code-property-graph-diao-yan">code property graph 调研</a>

        
            <ul class="toc-list">
              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#1-zi-liao">1. 资料</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-jie-gou">2. 结构</a>

        
            <ul class="toc-list">
              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-1-ast">2.1 AST</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-2-cfg">2.2 CFG</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-cpg">2.3 CPG</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-1-edge">2.3.1 Edge</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-2-node-key">2.3.2 Node Key</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-3-node-type">2.3.3 Node Type</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-5-kai-yuan-ban-de-validation">2.3.5 开源版的validation</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#2-3-6-bian-de-zuo-yong">2.3.6 边的作用</a>

        
    </li>

              
            </ul>
        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#4-hou-duan-shi-xian">4. 后端实现</a>

        
            <ul class="toc-list">
              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#4-1-call-graphfen-xi">4.1 call-graph分析</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#4-2-shu-ju-liu-fen-xi">4.2 数据流分析</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#tu">图</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#kuang-jia">框架</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#gen">gen</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#kill">kill</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#reach-def">REACH_DEF</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#4-3-shu-ju-cun-chu">4.3 数据存储</a>

        
    </li>

              
                  
    <li>
        <a href="https://fetchadd.github.io/blogs/code-property-graph-diao-yan/#4-4-cha-xun">4.4 查询</a>

        
    </li>

              
            </ul>
        
    </li>

              
            </ul>
        
    </li>

            
        </ul>
    </div>

    <ul id="toggle-toc">
        <li></li>
        <li></li>
        <li></li>
    </ul>
</div>

<div id="pseudo-page-id" style="display: none"></div>

            </div>
    </div>
</div>



<script type="text/javascript" src="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;js&#x2F;elasticlunr.min.js"></script>
<script type="text/javascript" src="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;search_index.zh.js"></script>
<script type="text/javascript" src="https:&#x2F;&#x2F;fetchadd.github.io&#x2F;js&#x2F;base.js"></script>

</body>
</html>